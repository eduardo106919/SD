
# Teste SD 18/12/2025

## Grupo 01

### Questão 01

Para evitar que o controlo de concorrência prejudique o desempenho, utilizam-se as seguintes estratégias:
- Redução da Granularidade: Em vez de bloquear uma base de dados inteira, bloqueia-se apenas a linha ou tabela necessária. Exemplo: Usar um trinco por conta bancária em vez de um trinco para o banco todo.
- Diminuição do tempo de posse: Manter apenas o código estritamente necessário dentro da secção crítica. Operações de I/O ou cálculos pesados devem ser feitos fora do lock.
- Locks de Leitura/Escrita: Permitir múltiplos leitores simultâneos, bloqueando apenas quando há um escritor.

### Questão 02

Estratégias de Threading em Sistema 3-tier
- Servidor Aplicacional A (sem estado): O ideal é um Thread Pool. Como não guarda estado persistente, pode processar muitos pedidos curtos em paralelo. Um modelo worker pool evita a criação excessiva de threads e permite alta escalabilidade.
- Servidor B (Base de Dados): Requer um threading mais conservador, muitas vezes limitado pelo número de ligações simultâneas suportadas pelo motor de busca. Utiliza-se geralmente uma thread por ligação ou filas de tarefas para garantir a consistência das transações no disco.

### Questão 03

Na segunda fase (Commit Phase), o coordenador já tomou a decisão global (Commit ou Abort). Como a decisão já foi registada no log do coordenador, o protocolo é resiliente. Se um participante falha, ele deve, ao recuperar, contactar o coordenador ou consultar o seu log local para saber o resultado final e completar a operação. O coordenador continuará a tentar enviar a decisão ao participante falhado até obter confirmação.

### Questão 04

**Desafio Principal**: A Localização Eficiente de dados num sistema de larga escala sem um servidor central. O desafio é encontrar "quem tem o quê" de forma rápida e escalável, sem inundar a rede com mensagens.

**Resolução pelo Chord**: O Chord utiliza uma Tabela de Hash Distribuída (DHT) organizada num anel lógico. Cada nó e cada dado recebe um ID. Cada nó mantém uma Finger Table (atalhos), permitindo que qualquer dado seja localizado em apenas `O(log N)` saltos, garantindo eficiência e auto-organização quando nós entram ou saem.

## Grupo 02

```java
class Manager {

    private static class Task {
        final String id;
        int freeSteps;
        int acquiredSteps;
        Set<String> deps;
        boolean completed;
        Lock tl;
        Condition tc;

        Task(String cod, int n, Set<String> d) {
            id = cod;
            freeSteps = n;
            acquiredSteps = 0;
            deps = d;
            completed = false;
            tl = new ReentrantLock();
            tc = tl.newCondition();
        }
    }

    Lock l = new ReentrantLock();
    Map<String, Task> tasks = new HashMap();
    Set<String> finished = new HashSet();

    void add(String id, int nsteps, Set<String> deps) {
        l.lock();
        try {
            tasks.put(id, new Task(id, nsteps, deps));
        } finally { l.unlock(); }
    }

    boolean acquire(String id) throws InterruptedException {
        Task t;
        l.lock();
        try {
            t = tasks.get(id);
            if (t == null)
                return false;

            t.tl.lock();
        } finally { l.unlock(); }

        try {
            if (t.completed == true)
                return false;

            if (t.freeSteps == 0)
                return false;
            
            // enquanto houver dependências
            while ()
                t.tc.await();
            
            return true;
        } finally { t.tl.unlock(); }
    }

    void complete(String id) {
        Task t;
        l.lock();
        try {
            t = task.get(id);
            if (t == null)
                return;
            
            t.tl.lock();
        } finally { l.unlock(); }

        try {
            t.nsteps--;
            t.tc.signalAll();
        } finally { t.tl.unlock(); }
    }

    Set<String> getCompleted() {
        l.lock();
        try {
            return finished.clone();
        } finally { l.unlock(); }
    }

}
```


## Grupo 03

```java
```
